  \subsection[Architecture infra]{Concevoir une infrastructure pour le cloud}

  \begin{frame}
    \frametitle{Adopter une philosophie DevOps}
    \begin{itemize}
      \item Infrastructure as Code
      \item Scale out plutôt que scale up (horizontalement plutôt que verticalement)
      \item HA niveau application plutôt qu'infrastructure
      \item Automatisation, automatisation, automatisation
      \item Tests
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{Automatisation}
    \begin{itemize}
      \item Automatiser la gestion de l'infrastructure : indispensable
      \item Création des ressources
      \item Configuration des ressources
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{Infrastructure as Code}
    \begin{itemize}
      \item Travailler comme un développeur
      \item Décrire son infrastructure sous forme de code (Heat, Ansible)
      \item Suivre les changements dans un VCS (git)
      \item Utiliser des outils de tests
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{Besoin d'orchestration}
    \begin{itemize}
      \item Manager tous les types de ressources par un point d'entrée
      \item Description de l'infrastructure dans un fichier (\textit{template})
      \item Heat (intégré à OpenStack), Terraform
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{Tests et intégration continue}
    \begin{itemize}
      \item Style de code
      \item Validation de la syntaxe
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{L'isolation}
    \begin{itemize}
      \item Niveau control plane : Tenant (projet)
      \item Niveau réseau : L2, L3, security groups
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{Security groups}
    \begin{itemize}
      \item Équivalent à un firewall devant chaque instance
      \item Une instance peut être associée à un ou plusieurs groupes de sécurité
      \item Gestion des accès en entrée et sortie
      \item Règles par protocole (TCP/UDP/ICMP) et par port
      \item Cible une adresse IP, un réseau ou un autre groupe de sécurité
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{Flavors}
    \begin{itemize}
      \item \textit{Gabarit}
      \item Équivalent des "instance types" d'AWS
      \item Définit un modèle d'instance en termes de CPU, RAM, disque (racine), disque éphémère
      \item Un disque de taille nul équivaut à prendre la taille de l'image de base
      \item Le disque éphémère a, comme le disque racine, l'avantage d'être souvent local donc rapide
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{Multi-tenant}
    \begin{itemize}
      \item Notion générale : un déploiement du logiciel permet de multiples utilisations
      \item Un cloud OpenStack permet aux utilisateurs de travailler dans des environnements isolés
      \item Les instances, réseaux, images, etc. sont associés à un tenant
      \item Certaines ressources peuvent être partagées entre tenants (exemple : image publique)
      \item On peut aussi parler de "projet"
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{Réseau}
    \begin{itemize}
      \item Fixed IP
      \item Multiples interfaces réseaux
      \item Floating IPs : pool, allocate, associate
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{Les instances}
    \begin{itemize}
      \item Éphémère
      \item Pets vs Cattle
      \item Basé sur une \textit{image}
      \item API de metadata
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{L'API de metadata}
    \begin{itemize}
      \item API à destination des instances
      \item Standard de fait initié par AWS
      \item Accessible depuis l'instance sur http://169.254.169.254/
      \item Expose des informations relatives à l'instance
      \item Expose un champ libre dit "userdata"
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{Monitoring}
    Monitoring
    \begin{itemize}
      \item Prendre en compte le cycle de vie des instances : DOWN != ALERT
      \item Monitorer le service plus que le serveur
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{Backup}
    Backuper, quoi ?
    \begin{itemize}
      \item Être capable de recréer ses instances (et le reste de son infrastructure)
      \item Données (applicatives, logs) : block, objet
    \end{itemize}
  \end{frame}

  \begin{frame}
    \frametitle{Un exemple : l'équipe openstack-infra}
    \begin{itemize}
      \item Infrastructure as code
      \item Infrastructure ouverte : code "open source"
      \item Utilise du cloud (hybride)
    \end{itemize}
  \end{frame}
